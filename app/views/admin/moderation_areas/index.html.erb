<div class="container">
  <div class="row">
      <div class="h1" style="display: flex; align-items: center;">
        <div style="flex-grow: 1">Zones de modération</div>
      </div>

      <div style="margin-bottom: 15px; display: flex">
        <div class="btn-group btn-group-sm">
          <% ModerationServices::Region.regions.each do |region| %>
            <%= link_to(region.name, @params.merge(region: region.id), class: "btn btn-#{@params[:region] == region.id.to_s ? :primary : :default}") %>
          <% end %>
        </div>

        <div style="margin-left: 15px">
          <%= link_to "Ajouter une zone de modération", new_admin_moderation_area_path, class: "btn btn-default-sm" %>
        </div>
      </div>

      <table class="table">
        <tr>
          <th></th>
          <th></th>
          <th>Modérateur</th>
          <th>Animateur</th>
          <th>Mobilisateur</th>
          <th>Sourcing</th>
          <th>Accompagnateur</th>
          <th>Community builder</th>
          <th>Slack ID</th>
          <th>Slack ID par défaut</th>
        </tr>
        <% @moderation_areas.each do |moderation_area| %>
          <tr>
            <td style="width: 3em">
              <% if moderation_area.activity? %>
                <span class="badge" style="background: #19534f" title="Zone active"><%= moderation_area.departement %></span>
              <% else %>
                <span class="badge" style="background: #d9534f" title="Zone non active"><%= moderation_area.departement %></span>
              <% end %>
            </td>

            <td><%= link_to moderation_area.name, edit_admin_moderation_area_path(moderation_area) %></td>

            <td><%= render partial: "admin/moderation_areas/update/moderator_form", locals: { moderation_area: moderation_area } %></td>
            <td><%= render partial: "admin/moderation_areas/update/animator_form", locals: { moderation_area: moderation_area } %></td>
            <td><%= render partial: "admin/moderation_areas/update/mobilisator_form", locals: { moderation_area: moderation_area } %></td>
            <td><%= render partial: "admin/moderation_areas/update/sourcing_form", locals: { moderation_area: moderation_area } %></td>
            <td><%= render partial: "admin/moderation_areas/update/accompanyist_form", locals: { moderation_area: moderation_area } %></td>
            <td><%= render partial: "admin/moderation_areas/update/community_builder_form", locals: { moderation_area: moderation_area } %></td>

            <td><%= render partial: "admin/moderation_areas/fields/slack_id", locals: { moderation_area: moderation_area } %></td>
            <td><%= render partial: "admin/moderation_areas/fields/default_slack_id", locals: { moderation_area: moderation_area } %></td>
          </tr>
        <% end %>
      </table>
  </div>
</div>

<script type="text/javascript">
  $(document).ready(function() {
    $(document).on('change', '.update-select', function() {
      $(this).closest('form').submit();
    });
  });
</script>
