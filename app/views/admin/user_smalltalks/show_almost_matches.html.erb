<div class="container">
  <%= render 'show_header', tab: :show_almost_matches %>

  <% if @almost_matches.any? %>
    <table class="custom-table">
      <thead>
        <tr>
          <th>#</th>
          <th>Utilisateur</th>
          <th>Créée le</th>
          <th>match_format</th>
          <th>profile</th>
          <th>match_locality</th>
          <th>match_gender</th>
          <th>match_interest</th>
          <th>Critères non matchés</th>
        </tr>
      </thead>
      <tbody>
        <% @almost_matches.each do |almost_matche| %>
          <tr>
            <td><%= link_to almost_matche.id, admin_user_smalltalk_path(almost_matche.id) %></td>
            <td><%= link_to almost_matche.user.full_name, edit_admin_user_path(almost_matche.user) %></td>
            <td><%= l almost_matche.created_at.to_date %></td>
            <td><%= almost_matche.match_format %></td>
            <td><%= boolean_label true, default: almost_matche.user_profile %></td>
            <td><%= boolean_label almost_matche.match_locality, default: almost_matche.user.city %></td>
            <td><%= boolean_label almost_matche.match_gender, default: almost_matche.user_gender %></td>
            <td>
              <% almost_matche.interest_names.each do |interest_name| %>
                <span class="badge bg-success"><%= interest_name %></span>
              <% end %>
            </td>
            <td></td>
          </tr>

          <tr>
            <td></td>
            <td></td>
            <td>Critère matché</td>
            <td><%= boolean_label almost_matche.has_matched_format, default: @user_smalltalk.match_format %></td>
            <td><%= boolean_label almost_matche.has_matched_profile, default: @user_smalltalk.user_profile %></td>
            <td><%= boolean_label almost_matche.has_matched_locality, default: @user_smalltalk.user.city %></td>
            <td><%= boolean_label almost_matche.has_matched_gender, default: @user_smalltalk.user_gender %></td>
            <td>
              <% @user_smalltalk.interest_names.each do |interest_name| %>
                <span class="badge bg-success"><%= interest_name %></span>
              <% end %>
            </td>
            <td><%= almost_matche.unmatch_count %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <div class="alert alert-info" role="alert" style="display: flex; align-items: center">
      <div style="flex-grow: 1">
        Aucun match exact n'est possible.
      </div>
    </div>
  <% end %>
</div>
