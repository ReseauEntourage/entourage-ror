<div class="row">
  <h1>Vérification de votre téléphone</h1>
</div>

<form class="form-horizontal" role="form" id="new_user" accept-charset="UTF-8" method="post">
  <div class="row">
    <div class="control-group">
      <div class="col-md-3">
        <label class="control-label">Téléphone</label>
        <div class="controls">
          <input class="form-control" required="required" type="text" name="phone" id="user_phone">
        </div>
      </div>
    </div>
  </div>
  <br>
  <div class="row">
    <a href="#" class="btn btn-success" id="validate">Vérifier cet appareil</a>
  </div>
</form>
<script>
  var ready = function() {
    var form = $("#new_user");
    $("#validate").click(function() {
      $.ajax({
        type: form.attr('method'),
        url: "/api/v1/users",
        data: {"user": {"phone": $("#user_phone").val()}},
        success: function(){
          window.location.href = "/test_tunnel/users/step2?phone="+encodeURIComponent($("#user_phone").val());
        },
        error: function(){
          console.log("error");
        }
      });
    });
  }
  $(document).ready(ready);
  $(document).on('page:load', ready);
</script>
